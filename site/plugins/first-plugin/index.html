<!DOCTYPE html>
<html lang="en" class="dark"><head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UrsaMU Documentation</title>
  <meta name="description" content="Create your first UrsaMU plugin with this step-by-step guide">
  <link rel="stylesheet" href="/styles.css">
  <link rel="stylesheet" href="/prism.css">
  <meta name="theme-color" content="#0f172a">
<meta property="og:type" content="website">
<meta property="og:url" content="https://ursamu.github.io/plugins/first-plugin/">
<meta name="twitter:card" content="summary">
</head>
<body class="min-h-screen flex flex-col bg-slate-900 text-slate-200">
  <!-- Header with navigation -->
  <header class="bg-slate-800 shadow-lg sticky top-0 z-10">
    <div class="container mx-auto px-4 py-3">
      <div class="flex justify-between items-center">
        <a href="/" class="text-2xl font-bold text-white flex items-center">
          <span class="text-purple-400 mr-2">UrsaMU</span> Docs
        </a>
        
        <nav class="hidden lg:block">
          <ul class="flex space-x-8">
            
            <li>
              <a href="/" class="text-slate-300 hover:text-purple-300 transition-colors py-2">Home</a>
            </li>
            
            <li>
              <a href="/guides/" class="text-slate-300 hover:text-purple-300 transition-colors py-2">Guides</a>
            </li>
            
            <li>
              <a href="/configuration/" class="text-slate-300 hover:text-purple-300 transition-colors py-2">Configuration</a>
            </li>
            
            <li>
              <a href="/api/" class="text-slate-300 hover:text-purple-300 transition-colors py-2">API Reference</a>
            </li>
            
            <li>
              <a href="/plugins/" class="text-slate-300 hover:text-purple-300 transition-colors py-2">Plugins</a>
            </li>
            
            <li>
              <a href="/development/" class="text-slate-300 hover:text-purple-300 transition-colors py-2">Development</a>
            </li>
            
          </ul>
        </nav>
        
        <button id="menu-toggle" class="lg:hidden text-white">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewbox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"></path>
          </svg>
        </button>
      </div>
    </div>
    
    <!-- Mobile menu -->
    <div id="mobile-menu" class="hidden lg:hidden border-t border-slate-700">
      <div class="container mx-auto px-4 py-3">
        <ul class="space-y-3">
          
          <li>
            <a href="/" class="block py-2 text-slate-300 hover:text-purple-300 transition-colors">Home</a>
          </li>
          
          <li>
            <a href="/guides/" class="block py-2 text-slate-300 hover:text-purple-300 transition-colors">Guides</a>
          </li>
          
          <li>
            <a href="/configuration/" class="block py-2 text-slate-300 hover:text-purple-300 transition-colors">Configuration</a>
          </li>
          
          <li>
            <a href="/api/" class="block py-2 text-slate-300 hover:text-purple-300 transition-colors">API Reference</a>
          </li>
          
          <li>
            <a href="/plugins/" class="block py-2 text-slate-300 hover:text-purple-300 transition-colors">Plugins</a>
          </li>
          
          <li>
            <a href="/development/" class="block py-2 text-slate-300 hover:text-purple-300 transition-colors">Development</a>
          </li>
          
        </ul>
      </div>
    </div>
  </header>

  <!-- Main content area -->
  <div class="container mx-auto px-4 py-8 flex-grow">
    <div class="flex flex-col lg:flex-row lg:gap-12">
      <!-- Sidebar navigation (if available) -->
      
      <aside class="lg:w-72 flex-shrink-0 mb-8 lg:mb-0 order-2 lg:order-1">
        <div class="sticky top-24 bg-slate-800 rounded-lg p-6 shadow-lg">
          <h3 class="text-lg font-semibold mb-4 text-white">On This Page</h3>
          <nav>
            
              <ul class="space-y-3 border-l border-slate-700 pl-4">
                
                <li>
                  <a href="#prerequisites" class="block py-1 text-purple-400 hover:text-purple-300 transition-colors">Prerequisites</a>
                </li>
                
                <li>
                  <a href="#creating-the-plugin-structure" class="block py-1 text-purple-400 hover:text-purple-300 transition-colors">Creating the Plugin Structure</a>
                </li>
                
                <li>
                  <a href="#implementing-the-plugin" class="block py-1 text-purple-400 hover:text-purple-300 transition-colors">Implementing the Plugin</a>
                </li>
                
                <li>
                  <a href="#testing-your-plugin" class="block py-1 text-purple-400 hover:text-purple-300 transition-colors">Testing Your Plugin</a>
                </li>
                
                <li>
                  <a href="#next-steps" class="block py-1 text-purple-400 hover:text-purple-300 transition-colors">Next Steps</a>
                </li>
                
              </ul>
            
          </nav>
        </div>
      </aside>
      
      
      <!-- Main content -->
      <main class="w-full order-1 lg:order-2 lg:max-w-3xl">
        <article class="prose prose-invert prose-headings:text-white prose-a:text-purple-400 prose-a:no-underline hover:prose-a:text-purple-300 prose-a:transition-colors max-w-none ">
          
          <h1>Creating Your First Plugin</h1>
<p>This guide will walk you through creating a simple UrsaMU plugin from scratch. We’ll create a “dice roller” plugin that adds commands for rolling dice in the game.</p>
<h2>Prerequisites</h2>
<p>Before you begin, make sure you have:</p>
<ol>
<li>A working UrsaMU installation</li>
<li>Basic knowledge of TypeScript</li>
<li>A code editor (VS Code recommended)</li>
</ol>
<h2>Creating the Plugin Structure</h2>
<p>UrsaMU provides a task to create a new plugin structure. Open your terminal and run:</p>
<pre class="language-bash" tabindex="0"><code class="language-bash">deno task create-plugin dice-roller
</code></pre>
<p>This will create a new directory <code>src/plugins/dice-roller/</code> with the following structure:</p>
<pre class="language-none" tabindex="0"><code class="language-none">src/plugins/dice-roller/
├── index.ts           # Main plugin file
├── scripts/           # Utility scripts
│   └── run.sh         # Script to run both servers
└── src/               # Source code
    ├── main.ts        # Main server entry point
    └── telnet.ts      # Telnet server entry point
</code></pre>
<p>If you prefer to create the structure manually, create the following files:</p>
<ol>
<li>Create the plugin directory:</li>
</ol>
<pre class="language-bash" tabindex="0"><code class="language-bash">mkdir -p src/plugins/dice-roller
</code></pre>
<ol start="2">
<li>Create the main plugin file:</li>
</ol>
<pre class="language-bash" tabindex="0"><code class="language-bash">touch src/plugins/dice-roller/index.ts
</code></pre>
<h2>Implementing the Plugin</h2>
<p>Now, let’s implement our dice roller plugin. Open <code>src/plugins/dice-roller/index.ts</code> and add the following code:</p>
<pre class="language-typescript" tabindex="0"><code class="language-typescript">import { App, IPlugin } from "ursamu";

/**
 * A plugin that adds dice rolling commands to UrsaMU
 */
export default class DiceRollerPlugin implements IPlugin {
  name = "dice-roller";
  version = "1.0.0";
  description = "Adds dice rolling commands to UrsaMU";
  author = "Your Name";
  
  // Default configuration
  config = {
    maxDice: 100,    // Maximum number of dice that can be rolled at once
    maxSides: 1000,  // Maximum number of sides per die
  };
  
  /**
   * Initialize the plugin
   */
  onInit(app: App): void {
    // Register the roll command
    app.commands.register("dice-roller", {
      name: "roll",
      pattern: "roll *",
      flags: "connected",
      exec: (ctx) =&gt; {
        const args = ctx.args.trim();
        
        // If no arguments, show help
        if (!args) {
          return ctx.send(`
            |cDice Roller Help|n
            Usage: roll &lt;number&gt;d&lt;sides&gt; [+/-&lt;modifier&gt;]
            Examples:
              roll 1d6       - Roll a 6-sided die
              roll 2d10      - Roll two 10-sided dice
              roll 3d6+2     - Roll three 6-sided dice and add 2
              roll 2d20-1    - Roll two 20-sided dice and subtract 1
          `);
        }
        
        // Parse the dice expression
        const result = this.parseDiceExpression(args);
        
        if (result.error) {
          return ctx.send(`|rError:|n ${result.error}`);
        }
        
        // Format the result
        const rollText = result.rolls.join(", ");
        const totalText = result.modifier !== 0 
          ? `${result.total - result.modifier} ${result.modifier &gt; 0 ? '+' : ''}${result.modifier} = ${result.total}`
          : result.total.toString();
        
        ctx.send(`
          |c${ctx.player.name} rolls ${args}|n
          Rolls: ${rollText}
          Total: ${totalText}
        `);
      }
    });
    
    console.log(`${this.name} initialized`);
  }
  
  /**
   * Parse a dice expression like "3d6+2"
   */
  parseDiceExpression(expression: string) {
    // Regular expression to match dice notation
    const diceRegex = /^(\d+)d(\d+)(?:([+-])(\d+))?$/i;
    const match = expression.match(diceRegex);
    
    if (!match) {
      return { error: "Invalid dice expression. Use format: NdS[+/-M] (e.g., 3d6+2)" };
    }
    
    const numDice = parseInt(match[1], 10);
    const numSides = parseInt(match[2], 10);
    const modifierSign = match[3] || "+";
    const modifierValue = match[4] ? parseInt(match[4], 10) : 0;
    const modifier = modifierSign === "+" ? modifierValue : -modifierValue;
    
    // Validate the dice parameters
    if (numDice &lt;= 0 || numDice &gt; this.config.maxDice) {
      return { error: `Number of dice must be between 1 and ${this.config.maxDice}` };
    }
    
    if (numSides &lt;= 0 || numSides &gt; this.config.maxSides) {
      return { error: `Number of sides must be between 1 and ${this.config.maxSides}` };
    }
    
    // Roll the dice
    const rolls: number[] = [];
    let total = 0;
    
    for (let i = 0; i &lt; numDice; i++) {
      const roll = Math.floor(Math.random() * numSides) + 1;
      rolls.push(roll);
      total += roll;
    }
    
    // Add the modifier
    total += modifier;
    
    return { rolls, total, modifier };
  }
  
  /**
   * Called when the plugin is loaded
   */
  onLoad(app: App): void {
    console.log(`${this.name} v${this.version} loaded!`);
  }
  
  /**
   * Called when the plugin is unloaded
   */
  onUnload(app: App): void {
    console.log(`${this.name} unloaded`);
  }
}
</code></pre>
<h2>Testing Your Plugin</h2>
<p>Now that you’ve created your plugin, let’s test it:</p>
<ol>
<li>Make sure your plugin is enabled in your configuration file (<code>config/config.json</code>):</li>
</ol>
<pre class="language-json" tabindex="0"><code class="language-json">{
  "plugins": {
    "dice-roller": {
      "maxDice": 100,
      "maxSides": 1000
    }
  }
}
</code></pre>
<ol start="2">
<li>Start your UrsaMU server:</li>
</ol>
<pre class="language-bash" tabindex="0"><code class="language-bash">deno task start
</code></pre>
<ol start="3">
<li>
<p>Connect to your server using a telnet client or the web interface.</p>
</li>
<li>
<p>Try using the roll command:</p>
</li>
</ol>
<pre class="language-none" tabindex="0"><code class="language-none">roll 3d6
</code></pre>
<p>You should see output similar to:</p>
<pre class="language-none" tabindex="0"><code class="language-none">YourName rolls 3d6
Rolls: 4, 2, 6
Total: 12
</code></pre>
<p>Try other dice expressions:</p>
<pre class="language-none" tabindex="0"><code class="language-none">roll 2d20+5
roll 1d100-10
roll 4d4
</code></pre>
<h2>Next Steps</h2>
<p>Congratulations! You’ve created your first UrsaMU plugin. Here are some ways you could extend this plugin:</p>
<ol>
<li>Add more dice rolling commands (e.g., <code>rollpublic</code>, <code>rollprivate</code>)</li>
<li>Add special dice types (e.g., Fate/Fudge dice, exploding dice)</li>
<li>Add dice macros that players can save and reuse</li>
<li>Add statistics tracking for dice rolls</li>
</ol>
<p>For more advanced plugin development, check out these guides:</p>
<ul>
<li><a href="./hooks.md">Plugin Hooks</a> - Learn how to hook into UrsaMU events</li>
<li><a href="./configuration.md">Plugin Configuration</a> - More advanced configuration options</li>
<li><a href="./dependencies.md">Plugin Dependencies</a> - How to depend on other plugins</li>
</ul>
<p>Remember that plugins are a powerful way to extend UrsaMU without modifying the core code. By keeping your customizations in plugins, you ensure that your game can be easily updated when new versions of UrsaMU are released.</p>

        </article>
      </main>
    </div>
  </div>

  <!-- Footer -->
  <footer class="bg-slate-800 py-8 mt-12 border-t border-slate-700">
    <div class="container mx-auto px-4">
      <div class="flex flex-col md:flex-row justify-between items-center">
        <div class="mb-6 md:mb-0">
          <p>© UrsaMU Team - <a href="https://github.com/lcanady/ursamu" class="text-purple-400 hover:text-purple-300 transition-colors">GitHub Repository</a></p>
        </div>
        <div>
          <p>Built with <a href="https://lume.land" class="text-purple-400 hover:text-purple-300 transition-colors">Lume</a> for <a href="https://deno.land" class="text-purple-400 hover:text-purple-300 transition-colors">Deno</a></p>
        </div>
      </div>
    </div>
  </footer>

  <script>
    // Mobile menu toggle
    document.getElementById('menu-toggle').addEventListener('click', function() {
      document.getElementById('mobile-menu').classList.toggle('hidden');
    });

    // Smooth scrolling for anchor links
    document.addEventListener('DOMContentLoaded', function() {
      // Add IDs to headings if they don't have them
      const article = document.querySelector('article');
      if (article) {
        const headings = article.querySelectorAll('h2, h3, h4, h5, h6');
        headings.forEach(heading => {
          if (!heading.id) {
            // Create ID from heading text
            const id = heading.textContent
              .toLowerCase()
              .replace(/[^\w\s-]/g, '')
              .replace(/[\s_-]+/g, '-')
              .replace(/^-+|-+$/g, '');
            heading.id = id;
          }
        });
      }
      
      // Get all links that have hash (#) in them
      const anchorLinks = document.querySelectorAll('a[href^="#"]');
      
      // Add click event listener to each anchor link
      anchorLinks.forEach(link => {
        link.addEventListener('click', function(e) {
          // Prevent default jump-to behavior
          e.preventDefault();
          
          // Get the target element
          const targetId = this.getAttribute('href');
          if (targetId === '#') return; // Skip if it's just "#"
          
          const targetElement = document.querySelector(targetId);
          
          if (targetElement) {
            // Calculate header height for offset
            const headerHeight = document.querySelector('header').offsetHeight;
            
            // Get the target's position
            const targetPosition = targetElement.getBoundingClientRect().top + window.pageYOffset;
            
            // Scroll to the target with offset for the header
            window.scrollTo({
              top: targetPosition - headerHeight - 20, // 20px extra padding
              behavior: 'smooth'
            });
            
            // Update URL hash without jumping
            history.pushState(null, null, targetId);
          }
        });
      });
    });
  </script>

 </body></html>